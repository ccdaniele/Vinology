{"ast":null,"code":"'use strict';\n\nconst web = require('../../dd-trace/src/plugins/util/web');\n\nfunction createWrapRebuild() {\n  return function wrapRebuild(rebuild) {\n    return function rebuildWithTrace(event) {\n      const result = rebuild.apply(this, arguments);\n\n      if (this && Array.isArray(this._cycle)) {\n        this._cycle = this._cycle.map(wrapMiddleware);\n      }\n\n      return result;\n    };\n  };\n}\n\nfunction createWrapLifecycle() {\n  return function wrapLifecycle(lifecycle) {\n    return function lifecycleWithTrace() {\n      const result = lifecycle.apply(this, arguments);\n      if (Array.isArray(result)) return result.map(wrapMiddleware);\n      return result;\n    };\n  };\n}\n\nfunction wrapMiddleware(middleware) {\n  if (typeof middleware !== 'function') return middleware;\n  return function (request, next) {\n    if (!request || !request.raw) return middleware.apply(this, arguments);\n    return web.reactivate(request.raw.req, () => middleware.apply(this, arguments));\n  };\n}\n\nmodule.exports = [{\n  name: '@hapi/hapi',\n  versions: ['>=17.9'],\n  file: 'lib/route.js',\n\n  patch(Route, tracer, config) {\n    this.wrap(Route.prototype, 'rebuild', createWrapRebuild(tracer, config));\n  },\n\n  unpatch(Route) {\n    this.unwrap(Route.prototype, 'rebuild');\n  }\n\n}, {\n  name: 'hapi',\n  versions: ['>=10.4'],\n  file: 'lib/route.js',\n\n  patch(Route, tracer, config) {\n    this.wrap(Route.prototype, 'rebuild', createWrapRebuild(tracer, config));\n  },\n\n  unpatch(Route) {\n    this.unwrap(Route.prototype, 'rebuild');\n  }\n\n}, {\n  name: 'hapi',\n  versions: ['2 - 10.3'],\n  file: 'lib/route.js',\n\n  patch(Route, tracer, config) {\n    this.wrap(Route.prototype, 'lifecycle', createWrapLifecycle(tracer, config));\n  },\n\n  unpatch(Route) {\n    this.unwrap(Route.prototype, 'lifecycle');\n  }\n\n}];","map":{"version":3,"sources":["/Users/danielcalderon/vinology/Vinology-client/node_modules/dd-trace/packages/datadog-plugin-hapi/src/route.js"],"names":["web","require","createWrapRebuild","wrapRebuild","rebuild","rebuildWithTrace","event","result","apply","arguments","Array","isArray","_cycle","map","wrapMiddleware","createWrapLifecycle","wrapLifecycle","lifecycle","lifecycleWithTrace","middleware","request","next","raw","reactivate","req","module","exports","name","versions","file","patch","Route","tracer","config","wrap","prototype","unpatch","unwrap"],"mappings":"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","sourcesContent":["'use strict'\n\nconst web = require('../../dd-trace/src/plugins/util/web')\n\nfunction createWrapRebuild () {\n  return function wrapRebuild (rebuild) {\n    return function rebuildWithTrace (event) {\n      const result = rebuild.apply(this, arguments)\n\n      if (this && Array.isArray(this._cycle)) {\n        this._cycle = this._cycle.map(wrapMiddleware)\n      }\n\n      return result\n    }\n  }\n}\n\nfunction createWrapLifecycle () {\n  return function wrapLifecycle (lifecycle) {\n    return function lifecycleWithTrace () {\n      const result = lifecycle.apply(this, arguments)\n\n      if (Array.isArray(result)) return result.map(wrapMiddleware)\n\n      return result\n    }\n  }\n}\n\nfunction wrapMiddleware (middleware) {\n  if (typeof middleware !== 'function') return middleware\n\n  return function (request, next) {\n    if (!request || !request.raw) return middleware.apply(this, arguments)\n\n    return web.reactivate(request.raw.req, () => middleware.apply(this, arguments))\n  }\n}\n\nmodule.exports = [\n  {\n    name: '@hapi/hapi',\n    versions: ['>=17.9'],\n    file: 'lib/route.js',\n    patch (Route, tracer, config) {\n      this.wrap(Route.prototype, 'rebuild', createWrapRebuild(tracer, config))\n    },\n    unpatch (Route) {\n      this.unwrap(Route.prototype, 'rebuild')\n    }\n  },\n  {\n    name: 'hapi',\n    versions: ['>=10.4'],\n    file: 'lib/route.js',\n    patch (Route, tracer, config) {\n      this.wrap(Route.prototype, 'rebuild', createWrapRebuild(tracer, config))\n    },\n    unpatch (Route) {\n      this.unwrap(Route.prototype, 'rebuild')\n    }\n  },\n  {\n    name: 'hapi',\n    versions: ['2 - 10.3'],\n    file: 'lib/route.js',\n    patch (Route, tracer, config) {\n      this.wrap(Route.prototype, 'lifecycle', createWrapLifecycle(tracer, config))\n    },\n    unpatch (Route) {\n      this.unwrap(Route.prototype, 'lifecycle')\n    }\n  }\n]\n"]},"metadata":{},"sourceType":"script"}